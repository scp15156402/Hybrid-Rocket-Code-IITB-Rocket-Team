<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Rocket Simulation{% endblock %}</title>
<link rel="stylesheet" href="{{ url_for('static', filename='simulations/css/sim_styles.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='simulations/css/sim_dark-styles.css') }}">

</head>
<body>
  <div class="app">
    {% include 'simulations/partials/header.html' %}

    <!-- RIBBON TOOLBAR -->
    <aside class="ribbon glass-panel" id="ribbon">
      <form method="POST">
        {% include 'simulations/partials/ribbon_tabs.html' %}
        {% include 'simulations/partials/ribbon_panels.html' %}
        <!-- Ribbon footer with collapse chevron -->
        <button type="button" id="collapse-btn" class="bottom-right-btn" onclick="toggleCollapse()" title="Collapse Ribbon">
          <i id="collapse-icon" class="bi bi-chevron-right"></i>
        </button>
      </form>
    </aside>

    <!-- MAIN CONTENT BELOW RIBBON -->
    <div class="main-content-below-ribbon">
      {% include 'simulations/partials/results_panel.html' %}
      {% include 'simulations/partials/plots.html' %}
    </div>
  </div>

  {% block scripts %}
<script src="{{ url_for('static', filename='simulations/js/ribbon.js') }}"></script>
<script src="{{ url_for('static', filename='simulations/js/results-panel.js') }}"></script>
<script src="{{ url_for('static', filename='simulations/js/header-particles.js') }}"></script>
<script src="{{ url_for('static', filename='simulations/js/dark-mode.js') }}"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const toggleButton = document.getElementById("dark-mode-toggle");
      const darkIcon = document.getElementById("dark-mode-icon");
      const lightLink = document.getElementById("light-style");
      const darkLink = document.getElementById("dark-style");

      function applyTheme(theme) {
        if (theme === "dark") {
          darkLink.disabled = false;
          lightLink.disabled = true;
          darkIcon.className = "bi bi-sun";
        } else {
          darkLink.disabled = true;
          lightLink.disabled = false;
          darkIcon.className = "bi bi-moon";
        }
        localStorage.setItem("color-scheme", theme);
      }

      toggleButton.addEventListener("click", () => {
        const currentTheme = darkLink.disabled ? "light" : "dark";
        const nextTheme = currentTheme === "light" ? "dark" : "light";
        applyTheme(nextTheme);
      });

      const stored = localStorage.getItem("color-scheme") || "light";
      applyTheme(stored);
    });
  </script>
  <script>
    function updateSliderTrack(slider) {
      const min = slider.min ? parseFloat(slider.min) : 0;
      const max = slider.max ? parseFloat(slider.max) : 100;
      const value = parseFloat(slider.value);
      const percent = ((value - min) / (max - min)) * 100;
      slider.style.background = `linear-gradient(to right, var(--color-primary) 0%, var(--color-primary) ${percent}%, var(--color-border) ${percent}%, var(--color-border) 100%)`;
    }
    document.addEventListener('DOMContentLoaded', () => {
      const sliders = document.querySelectorAll('input[type="range"]');
      sliders.forEach(slider => {
        updateSliderTrack(slider);
        slider.addEventListener('input', () => updateSliderTrack(slider));
      });
    });
  </script>
  {% endblock %}
</body>
</html>
